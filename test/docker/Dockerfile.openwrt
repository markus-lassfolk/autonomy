# OpenWrt Test Environment Dockerfile
FROM alpine:latest

# Install required packages for testing
RUN apk update && \
    apk add --no-cache \
    bash \
    curl \
    wget \
    jq \
    procps \
    iputils \
    net-tools \
    git \
    make \
    gcc \
    musl-dev \
    && rm -rf /var/cache/apk/*

# Set up test environment
WORKDIR /root
COPY . /autonomy/

# Create test directories
RUN mkdir -p /etc/config /var/log /tmp/autonomy

# Set up basic configuration
RUN echo "config system" > /etc/config/system && \
    echo "    option hostname 'openwrt-test'" >> /etc/config/system && \
    echo "    option timezone 'UTC'" >> /etc/config/system

# Expose ports for testing
EXPOSE 80 443 8080

# Default command
CMD ["/bin/sh"]
